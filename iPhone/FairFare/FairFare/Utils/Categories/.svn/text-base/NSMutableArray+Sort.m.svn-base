
#import "NSMutableArray+Sort.h"

@implementation NSMutableArray (Sort)

//method to simply reverse an NSMutableArray
- (void)reverse {
    
    DebugLog();
    
    if ([self count] == 0)
    return;
    
    NSUInteger i = 0;
    NSUInteger j = [self count] - 1;
    while (i < j) {
        [self exchangeObjectAtIndex:i
                  withObjectAtIndex:j];
        
        i++;
        j--;
    }
}

- (void)sortPosDescByKey:(NSString *)key
{
    DebugLog();
    
    if ([self count] == 0)
    return;
  
    int i = 0;
    
    for (;i < [self count]; i++){
        
        int a = [[[self objectAtIndex:i] valueForKey:key] integerValue];
        if(a > 0)
        break;
    }
    
    if(i == 0){ //all a3Id's are positive. Just reverse them.
        [self reverse];
    }
    else { //some negative a3Id's are present. Let's handle sorting accordingly. Negative a3Id's will always appear on top in ascending orer.
        
        NSMutableArray *negArray = [[NSMutableArray alloc] initWithCapacity:i];
        int a = [[[self objectAtIndex:0] valueForKey:key] integerValue];
        
        while (a < 0) {
            
            [negArray addObject:[self objectAtIndex:0]];
            [self removeObject:[self objectAtIndex:0]];
            
            if([self count] == 0){
                break;
            }
            
            a = [[[self objectAtIndex:0] valueForKey:key] integerValue];
        }

        //reverse the postive array
        [self reverse]; 
        
        //insert the negative values as-is
        [self insertObjects:negArray atIndexes:[NSIndexSet indexSetWithIndexesInRange:NSMakeRange(0, [negArray count])]];
        
        //release neg array
        [negArray release];
    }
}

- (void)sortNegDescByKey:(NSString *)key
{
    DebugLog();
    
    if ([self count] == 0)
    return;
    
    int i = 0;
    
    for (;i < [self count]; i++){
        
        int a = [[[self objectAtIndex:i] valueForKey:key] integerValue];
        if(a > 0)
            break;
    }
    
    if(i == 0){ //all a3Id's are positive. Just reverse them.
        return;
    }
    else { //some negative a3Id's are present. Let's handle sorting accordingly. Negative a3Id's will always appear on top in ascending orer.
        
        NSMutableArray *negArray = [[NSMutableArray alloc] initWithCapacity:i];
        int a = [[[self objectAtIndex:0] valueForKey:key] integerValue];
        
        while (a < 0) {
            
            [negArray addObject:[self objectAtIndex:0]];
            [self removeObject:[self objectAtIndex:0]];
            
            if([self count] == 0){
                break;
            }

            a = [[[self objectAtIndex:0] valueForKey:key] integerValue];
        }
        
        //reverse the negative array
        [negArray reverse]; 
        
        //add the negative values
        [self addObjectsFromArray:negArray];
        
        //release neg array
        [negArray release];
    }
}


@end
